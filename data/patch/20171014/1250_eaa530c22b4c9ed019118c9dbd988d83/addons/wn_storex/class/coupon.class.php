<?php
 goto skZ7y; gm1Bt: load()->classs("\143\157\x75\160\x6f\x6e"); goto vC37A; skZ7y: defined("\111\x4e\137\x49\101") or die("\101\x63\x63\x65\163\x73\40\x44\145\x6e\151\x65\144"); goto gm1Bt; vC37A: class WnCoupon extends coupon { public function BuildCardExt($id, $openid = '', $type = "\143\x6f\x75\x70\157\156") { goto hHxo_; iR3tX: return $signature; goto OvYjd; x7wCG: HQcHE: goto kRIDK; OvYjd: DW4zk: goto hiG8T; hHxo_: $card_id = pdo_fetchcolumn("\x53\x45\x4c\x45\103\x54\40\143\141\162\x64\x5f\x69\144\x20\106\x52\x4f\x4d\x20" . tablename("\x73\164\157\x72\145\x78\137\x63\157\165\160\x6f\156") . "\x20\x57\x48\x45\122\x45\40\x69\x64\x20\x3d\40\x3a\x69\144", array("\x3a\151\x64" => $id)); goto lhSLE; nxFdG: if ($MQjLr) { goto DW4zk; } goto iR3tX; hiG8T: $cardExt = array("\164\x69\x6d\x65\163\164\x61\x6d\160" => $time, "\x73\x69\x67\x6e\x61\164\x75\162\x65" => $signature); goto MJczH; q3233: $MQjLr = !is_error($signature); goto nxFdG; Gpwlz: $sign = array($card_id, $time); goto cKtmB; MJczH: $cardExt = json_encode($cardExt); goto dmxdy; NKt0m: if ($mfIlv) { goto HQcHE; } goto YUy6J; dmxdy: return array("\x63\x61\162\x64\137\x69\x64" => $card_id, "\143\x61\x72\x64\137\145\x78\x74" => $cardExt); goto rdKcm; lhSLE: $mfIlv = !empty($card_id); goto NKt0m; kRIDK: $time = TIMESTAMP; goto Gpwlz; YUy6J: return error(-1, "\xe5\x8d\241\345\x88\xb8\x69\x64\344\xb8\215\xe5\x90\x88\xe6\xb3\225"); goto x7wCG; cKtmB: $signature = $this->SignatureCard($sign); goto q3233; rdKcm: } }